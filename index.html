<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Bé Tập Gõ 10 Ngón - Tùy Biến</title>
    <style>
        :root { --primary: #3498db; --accent: #e67e22; --bg: #f0f2f5; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        /* Tab Menu */
        .tab-menu { margin-top: 20px; display: flex; gap: 10px; }
        .tab-btn { padding: 10px 25px; cursor: pointer; border: none; border-radius: 15px 15px 0 0; background: #cbd5e0; font-weight: bold; transition: 0.3s; }
        .tab-btn.active { background: white; color: var(--primary); box-shadow: 0 -5px 10px rgba(0,0,0,0.05); }

        .container { background: white; width: 90%; max-width: 900px; padding: 30px; border-radius: 0 0 30px 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .content-tab { display: none; }
        .content-tab.active { display: block; }

        /* Giao diện luyện tập */
        #display-word { font-size: 40px; color: #2c3e50; font-weight: bold; margin-bottom: 20px; min-height: 60px; }
        #telex-hint-area { background: #f8fafc; padding: 20px; border-radius: 15px; border: 2px dashed #cbd5e0; margin-bottom: 30px; min-height: 40px; line-height: 1.8; }
        .char { font-size: 32px; display: inline-block; margin: 0 4px; color: #94a3b8; font-family: 'Courier New', monospace; font-weight: bold; }
        .char.active { color: #e67e22; background: #fef3c7; border-radius: 8px; padding: 0 5px; border-bottom: 4px solid #f59e0b; }
        .char.done { color: #10b981; }

        /* Bàn tay */
        .hands-area { display: flex; gap: 50px; justify-content: center; margin-top: 20px; }
        .hand-svg { width: 200px; height: 180px; }
        .finger { fill: #e2e8f0; stroke: #94a3b8; stroke-width: 2; transition: 0.15s; }
        .finger.highlight { fill: var(--accent); stroke: #d35400; transform: translateY(-10px); }

        /* Giao diện cài đặt */
        textarea { width: 100%; height: 150px; padding: 15px; border-radius: 10px; border: 2px solid #cbd5e0; font-size: 16px; margin-bottom: 15px; resize: none; }
        .save-btn { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; }
    </style>
</head>
<body>

    <div class="tab-menu">
        <button class="tab-btn active" onclick="showTab('practice-tab')">Luyện Tập</button>
        <button class="tab-btn" onclick="showTab('settings-tab')">Nhập Nội Dung</button>
    </div>

    <div class="container">
        <div id="practice-tab" class="content-tab active">
            <div id="display-word">Quê hương là chùm khế ngọt</div>
            <div id="telex-hint-area"></div>
            
            <div class="hands-area">
                <svg class="hand-svg" viewBox="0 0 200 180">
                    <rect id="f1" class="finger" x="10" y="50" width="30" height="70" rx="15" />
                    <rect id="f2" class="finger" x="50" y="20" width="30" height="90" rx="15" />
                    <rect id="f3" class="finger" x="90" y="10" width="30" height="100" rx="15" />
                    <rect id="f4" class="finger" x="130" y="20" width="30" height="90" rx="15" />
                    <rect id="f5" class="finger" x="160" y="110" width="40" height="60" rx="20" transform="rotate(-20 180 140)" />
                    <path d="M10,120 Q10,170 180,170 L180,120 Z" fill="#e2e8f0" stroke="#94a3b8" stroke-width="2" />
                </svg>
                <svg class="hand-svg" viewBox="0 0 200 180">
                    <rect id="f6" class="finger" x="0" y="110" width="40" height="60" rx="20" transform="rotate(20 20 140)" />
                    <rect id="f7" class="finger" x="40" y="20" width="30" height="90" rx="15" />
                    <rect id="f8" class="finger" x="80" y="10" width="30" height="100" rx="15" />
                    <rect id="f9" class="finger" x="120" y="20" width="30" height="90" rx="15" />
                    <rect id="f10" class="finger" x="160" y="50" width="30" height="70" rx="15" />
                    <path d="M20,170 Q190,170 190,120 L20,120 Z" fill="#e2e8f0" stroke="#94a3b8" stroke-width="2" />
                </svg>
            </div>
        </div>

        <div id="settings-tab" class="content-tab">
            <h3>Dán nội dung cần gõ vào đây (Tiếng Việt):</h3>
            <textarea id="user-input" placeholder="Ví dụ: Con mèo trèo cây cau..."></textarea>
            <br>
            <button class="save-btn" onclick="saveContent()">Bắt đầu luyện tập</button>
        </div>
    </div>

    <script>
        // Hàm chuyển đổi tiếng Việt sang mã gõ Telex
        function toTelex(text) {
            const map = {
                'á':'as','à':'af','ả':'ar','ã':'ax','ạ':'aj','â':'aa','ấ':'aas','ầ':'aaf','ẩ':'aar','ẫ':'aax','ậ':'aaj','ă':'aw','ắ':'aws','ằ':'awf','ẳ':'awr','ẵ':'awx','ặ':'awj',
                'é':'es','è':'ef','ẻ':'er','ẽ':'ex','ẹ':'ej','ê':'ee','ế':'ees','ề':'eef','ể':'eer','ễ':'eex','ệ':'eej',
                'í':'is','ì':'if','ỉ':'ir','ĩ':'ix','ị':'ij',
                'ó':'os','ò':'of','ỏ':'or','õ':'ox','ọ':'oj','ô':'oo','ố':'oos','ồ':'oof','ổ':'oor','ỗ':'oox','ộ':'ooj','ơ':'ow','ớ':'ows','ờ':'owf','ở':'owr','ỡ':'owx','ợ':'owj',
                'ú':'us','ì':'uf','ủ':'ur','ũ':'ux','ụ':'uj','ư':'uw','ứ':'uws','ừ':'uwf','ử':'uwr','ữ':'uwx','ự':'uwj',
                'ý':'ys','ỳ':'yf','ỷ':'yr','ỹ':'yx','ỵ':'yj','đ':'dd'
            };
            let res = "";
            for (let char of text.toLowerCase()) {
                res += map[char] || char;
            }
            return res + " ";
        }

        let fullText = "Quê hương là chùm khế ngọt";
        let telexScript = toTelex(fullText);
        let charIdx = 0;

        const fMap = {
            'a':'f1','q':'f1','z':'f1','s':'f2','w':'f2','x':'f2','d':'f3','e':'f3','c':'f3',
            'f':'f4','r':'f4','v':'f4','g':'f4','t':'f4','b':'f4','h':'f7','y':'f7','n':'f7',
            'm':'f7','u':'f7','j':'f7','k':'f8','i':'f8','l':'f9','o':'f9','p':'f10',' ':'f6'
        };

        function showTab(id) {
            document.querySelectorAll('.content-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function saveContent() {
            const input = document.getElementById('user-input').value.trim();
            if (input) {
                fullText = input;
                telexScript = toTelex(fullText);
                charIdx = 0;
                document.getElementById('display-word').innerText = fullText;
                showTab('practice-tab');
                updateUI();
            }
        }

        function updateUI() {
            const hintArea = document.getElementById('telex-hint-area');
            hintArea.innerHTML = telexScript.split('').map((c, i) => {
                let cls = i < charIdx ? "done" : (i === charIdx ? "active" : "");
                return `<span class="char ${cls}">${c === ' ' ? '␣' : c}</span>`;
            }).join('');

            document.querySelectorAll('.finger').forEach(f => f.classList.remove('highlight'));
            const fingerId = fMap[telexScript[charIdx].toLowerCase()];
            if (fingerId) document.getElementById(fingerId).classList.add('highlight');
        }

        window.addEventListener('keydown', (e) => {
            if (document.activeElement.tagName === 'TEXTAREA') return;
            if (e.code === "Space") e.preventDefault();
            
            const expected = telexScript[charIdx].toLowerCase();
            if (e.key.toLowerCase() === expected) {
                charIdx++;
                if (charIdx >= telexScript.length) {
                    alert("Hoàn thành rồi!");
                    charIdx = 0;
                }
                updateUI();
            }
        });

        // Khởi tạo lần đầu
        document.getElementById('display-word').innerText = fullText;
        updateUI();
    </script>
</body>
</html>
